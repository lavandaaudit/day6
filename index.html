<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBONARIUM ¬∑ TIME RELATIVITY REALTIME</title>

<style>
body {
    margin: 0;
    background: #000;
    color: #00ff9c;
    font-family: monospace;
}

.container {
    padding: 16px;
    max-width: 900px;
    margin: auto;
}

h1 {
    font-size: 20px;
    margin-bottom: 8px;
}

.subtitle {
    font-size: 11px;
    opacity: 0.6;
    margin-bottom: 18px;
}

.grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
}

.card {
    border: 1px solid rgba(0,255,150,0.35);
    padding: 14px;
    border-radius: 14px;
    background: rgba(0,255,150,0.03);
    backdrop-filter: blur(6px);
}

.label {
    font-size: 11px;
    opacity: 0.7;
}

.value {
    font-size: 22px;
    margin-top: 6px;
}

.desc {
    font-size: 11px;
    margin-top: 8px;
    opacity: 0.65;
    line-height: 1.35;
}

.matrixCard {
    position: relative;
    overflow: hidden;
}

#matrixCanvas {
    width: 100%;
    height: 220px;
    display: block;
}

.bigIndex {
    margin-top: 18px;
    border: 1px solid rgba(0,255,200,0.6);
    border-radius: 18px;
    padding: 18px;
    background: rgba(0,255,200,0.04);
}

.indexValue {
    font-size: 38px;
    margin-top: 6px;
}

.alertBox {
    margin-top: 12px;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.2);
    font-size: 12px;
}

.footer {
    margin-top: 18px;
    font-size: 10px;
    opacity: 0.5;
}
</style>
</head>

<body>
<div class="container">

<h1>IBONARIUM ¬∑ REALTIME TIME RELATIVITY MONITOR</h1>
<div class="subtitle">
Realtime –æ—Ü—ñ–Ω–∫–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ—Å—Ç—ñ —á–∞—Å—É —á–µ—Ä–µ–∑ —Ç–µ—Ö–Ω–æ, –º–µ—Ä–µ–∂–µ–≤—ñ —Ç–∞ —Ä–µ–ª—è—Ç–∏–≤—ñ—Å—Ç—Å—å–∫—ñ –ø—Ä–æ–∫—Å—ñ-–º–µ—Ç—Ä–∏–∫–∏
</div>

<div class="grid">

<div class="card">
<div class="label">LOCAL ATOMIC TIME (SIM)</div>
<div class="value" id="atomicTime">--</div>
<div class="desc">
–ë–∞–∑–æ–≤–∏–π –µ—Ç–∞–ª–æ–Ω —á–∞—Å—É —Å–∏—Å—Ç–µ–º–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –ª–æ–∫–∞–ª—å–Ω–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–∞ —Ç–æ—á–∫–∞.
</div>
</div>

<div class="card">
<div class="label">GPS RELATIVITY OFFSET (SIM)</div>
<div class="value" id="gpsOffset">--</div>
<div class="desc">
–†–µ–ª—è—Ç–∏–≤—ñ—Å—Ç—Å—å–∫–∞ –ø–æ–ø—Ä–∞–≤–∫–∞ –º—ñ–∂ —Å—É–ø—É—Ç–Ω–∏–∫–æ–≤–∏–º —Ç–∞ –∑–µ–º–Ω–∏–º —á–∞—Å–æ–º.
</div>
</div>

<div class="card">
<div class="label">NETWORK LATENCY</div>
<div class="value" id="latency">--</div>
<div class="desc">
–ü—Ä–æ–∫—Å—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ –ø–µ—Ä–µ–¥–∞—á—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó ‚Äî —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏–π —á–∞—Å —Ü–∏–≤—ñ–ª—ñ–∑–∞—Ü—ñ—ó.
</div>
</div>

<div class="card">
<div class="label">37s PHASE CYCLE</div>
<div class="value" id="cycle">--</div>
<div class="desc">
–ú—ñ–∫—Ä–æ-—Ñ–∞–∑–∞ IBONARIUM ‚Äî —É–º–æ–≤–Ω–∏–π –∫–≤–∞–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥—É —Å—Ç–∞–Ω—ñ–≤.
</div>
</div>

<div class="card">
<div class="label">TEMPORAL DRIFT (DERIVED)</div>
<div class="value" id="drift">--</div>
<div class="desc">
–ü–æ—Ö—ñ–¥–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Å–∏—Å—Ç–µ–º –º—ñ–∂ —Å–æ–±–æ—é.
</div>
</div>

<div class="card matrixCard">
<div class="label">TIME MATRIX STREAM</div>
<canvas id="matrixCanvas"></canvas>
<div class="desc">
–ú–∞—Ç—Ä–∏—Ü—è —á–∞—Å—É —Ä–µ–∞–≥—É—î –Ω–∞ –≤—Å—ñ 5 –º–µ—Ç—Ä–∏–∫ + Time Index (—à–≤–∏–¥–∫—ñ—Å—Ç—å, —â—ñ–ª—å–Ω—ñ—Å—Ç—å, –∫–æ–ª—ñ—Ä).
</div>
</div>

</div>

<div class="bigIndex">
<div class="label">TIME IBONARIUM INDEX</div>
<div class="indexValue" id="timeIndex">--</div>

<div class="alertBox" id="alertBox">
–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö...
</div>
</div>

<div class="footer">
IBONARIUM LAB ¬∑ UPDATE 500ms ¬∑ TEMPORAL MATRIX ACTIVE
</div>

</div>

<script>

// ===== METRICS =====

function updateAtomicTime() {
    const now = new Date();
    document.getElementById("atomicTime").textContent = now.toISOString();
}

function updateGpsOffset() {
    const base = 38;
    const noise = (Math.random() - 0.5) * 3;
    const value = base + noise;
    document.getElementById("gpsOffset").textContent = value.toFixed(3) + " Œºs";
    return value;
}

async function measureLatency() {
    try {
        const start = performance.now();
        await fetch("https://worldtimeapi.org/api/timezone/Etc/UTC", {cache:"no-store"});
        const end = performance.now();
        const latency = end - start;
        document.getElementById("latency").textContent = latency.toFixed(1) + " ms";
        return latency;
    } catch {
        document.getElementById("latency").textContent = "offline";
        return 0;
    }
}

function updateCycle() {
    const t = Date.now() / 1000;
    const phase = (t % 37) / 37;
    document.getElementById("cycle").textContent = phase.toFixed(3);
    return phase;
}

function calcDrift(gps, latency, cycle) {
    return Math.abs(gps/40 - latency/200) + cycle * 0.2;
}

function calcTimeIbonariumIndex(gps, latency, cycle, drift) {
    return (gps/40)*0.35 + (latency/200)*0.25 + cycle*0.2 + drift*0.2;
}

function updateAlert(index) {
    const box = document.getElementById("alertBox");

    if (index < 0.4) {
        box.innerHTML = "üü¢ –°–ò–ù–•–†–û–ù–Ü–Ø ¬∑ –°—Ç–∞–±—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä-—á–∞—Å";
        box.style.borderColor = "#00ff9c";
    }
    else if (index < 0.7) {
        box.innerHTML = "üü° –§–ê–ó–û–í–ò–ô –ó–°–£–í ¬∑ –ß–∞—Å–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏ —Ä–æ–∑—Ö–æ–¥—è—Ç—å—Å—è";
        box.style.borderColor = "#ffaa00";
    }
    else {
        box.innerHTML = "üî¥ TEMPORAL TURBULENCE ¬∑ –ô–º–æ–≤—ñ—Ä–Ω—ñ —Ñ–∞–∑–æ–≤—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏";
        box.style.borderColor = "#ff3366";
    }
}

// ===== MATRIX TIME RAIN =====

const canvas = document.getElementById("matrixCanvas");
const ctx = canvas.getContext("2d");

let drops = [];
let fontSize = 14;
let columns;
let matrixSpeed = 1;
let matrixDensity = 1;
let matrixColor = "#00ff9c";

function resizeMatrix() {
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;

    columns = Math.floor(canvas.width / fontSize);
    drops = Array(columns).fill(1);
}

window.addEventListener("resize", resizeMatrix);
resizeMatrix();

function updateMatrixFromIndex(index, drift) {
    matrixSpeed = 0.5 + index * 2;
    matrixDensity = 0.5 + drift;

    if (index < 0.4) matrixColor = "#00ff9c";
    else if (index < 0.7) matrixColor = "#ffaa00";
    else matrixColor = "#ff3366";
}

function drawMatrix() {
    ctx.fillStyle = "rgba(0,0,0,0.08)";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    ctx.fillStyle = matrixColor;
    ctx.font = fontSize + "px monospace";

    for (let i=0;i<drops.length;i++){
        if (Math.random() < matrixDensity) {
            const text = Math.random() > 0.5 ? "1" : "0";
            ctx.fillText(text, i*fontSize, drops[i]*fontSize);
        }

        if (drops[i]*fontSize > canvas.height && Math.random()>0.975) drops[i]=0;
        drops[i]+=matrixSpeed;
    }

    requestAnimationFrame(drawMatrix);
}

drawMatrix();

// ===== MAIN LOOP =====

async function mainLoop() {
    updateAtomicTime();
    const gps = updateGpsOffset();
    const latency = await measureLatency();
    const cycle = updateCycle();

    const drift = calcDrift(gps, latency, cycle);
    document.getElementById("drift").textContent = drift.toFixed(3);

    const index = calcTimeIbonariumIndex(gps, latency, cycle, drift);
    document.getElementById("timeIndex").textContent = index.toFixed(3);

    updateAlert(index);
    updateMatrixFromIndex(index, drift);
}

setInterval(mainLoop, 500);
mainLoop();

</script>

</body>
</html>
