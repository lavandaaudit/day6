<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBONARIUM ¬∑ DUAL RADAR</title>
<style>
    body {
        margin: 0;
        background: #000;
        color: #00ff9c;
        font-family: monospace;
        min-height: 100vh;
        overflow-x: hidden;
    }
    .main-wrapper {
        display: flex;
        flex-direction: row;
        height: 100vh;
        width: 100vw;
    }
    .section {
        flex: 1;
        padding: 20px 12px;
        overflow-y: auto;
        position: relative;
    }
    .section.left {
        border-right: 1px solid rgba(0,255,150,0.15);
    }
    .section.right {
        background: rgba(140,80,220,0.02);
    }
    .container {
        max-width: 480px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
    }
    h1 {
        font-size: 17px;
        margin: 0 0 8px 0;
        letter-spacing: 1px;
        text-align: center;
    }
    .subtitle {
        font-size: 9px;
        opacity: 0.65;
        text-align: center;
        margin-bottom: 16px;
    }
    .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }
    .card {
        border: 1px solid rgba(0,255,150,0.35);
        padding: 10px;
        border-radius: 12px;
        background: rgba(0,255,150,0.03);
        backdrop-filter: blur(6px);
        min-height: 78px;          /* –æ–¥–Ω–∞–∫–æ–≤–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –≤–∏—Å–æ—Ç–∞ –∫–∞—Ä—Ç–æ–∫ */
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .section.right .card {
        border-color: rgba(180,120,255,0.35);
        background: rgba(140,80,220,0.03);
    }
    .label { font-size: 9px; opacity: 0.7; }
    .value { font-size: 16px; margin-top: 4px; }
    .desc { font-size: 9px; margin-top: 6px; opacity: 0.65; line-height: 1.3; }
    .matrixCard {
        grid-column: 1 / -1;
        height: 180px;              /* –æ–¥–Ω–∞–∫–æ–≤–∞ –≤–∏—Å–æ—Ç–∞ –¥–ª—è –æ–±–æ—Ö –º–∞—Ç—Ä–∏—Ü—å */
        border: 1px solid rgba(0,255,150,0.3);
        border-radius: 12px;
        overflow: hidden;
    }
    .section.right .matrixCard {
        border-color: rgba(180,120,255,0.3);
    }
    .bigIndex {
        margin: 16px 0;
        padding: 14px;
        border: 1px solid rgba(0,255,200,0.6);
        border-radius: 16px;
        background: rgba(0,255,200,0.04);
        text-align: center;
    }
    .section.right .bigIndex {
        border-color: rgba(180,120,255,0.6);
        background: rgba(140,80,220,0.04);
    }
    .indexValue { font-size: 28px; margin: 6px 0; }
    .alertBox {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid rgba(255,255,255,0.2);
        font-size: 10px;
        min-height: 44px;
    }
    .footer {
        text-align: center;
        font-size: 8px;
        opacity: 0.5;
        margin-top: 12px;
    }
    canvas.starCanvas {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        z-index: 0;
        pointer-events: none;
    }
    /* –î–ª—è –ø—Ä–∞–≤–æ–≥–æ —Ä–∞–¥–∞—Ä–∞ ‚Äî —Ç—Ä–æ—Ö–∏ —Ñ—ñ–æ–ª–µ—Ç–æ–≤—ñ –∞–∫—Ü–µ–Ω—Ç–∏ */
    .section.right .alertBox.high { border-color: #ff4488; }
    .section.right .alertBox.medium { border-color: #ffdd44; }
    .section.right .alertBox.low { border-color: #a0ffdd; }

    @media (max-width: 900px) {
        .main-wrapper {
            flex-direction: column;
        }
        .section.left {
            border-right: none;
            border-bottom: 1px solid rgba(0,255,150,0.15);
        }
        .section {
            height: auto;
            min-height: 100vh;
        }
    }
</style>
</head>
<body>
<canvas id="starCanvas" class="starCanvas"></canvas>
<div class="main-wrapper">

    <!-- –õ–Ü–í–ò–ô –†–ê–î–ê–†: TIME TIME MONITOR -->
    <div class="section left">
        <div class="container">
            <h1>IBONARIUM ¬∑ TIME TIME MONITOR</h1>
            <div class="subtitle">Realtime –æ—Ü—ñ–Ω–∫–∞ –≤—ñ–¥–Ω–æ—Å–Ω–æ—Å—Ç—ñ —á–∞—Å—É</div>
            <div class="grid">
                <div class="card">
                    <div class="label">LOCAL ATOMIC TIME</div>
                    <div class="value" id="atomicTime">--</div>
                    <div class="desc">–ë–∞–∑–æ–≤–∏–π –µ—Ç–∞–ª–æ–Ω —á–∞—Å—É —Å–∏—Å—Ç–µ–º–∏</div>
                </div>
                <div class="card">
                    <div class="label">GPS RELATIVITY OFFSET</div>
                    <div class="value" id="gpsOffset">--</div>
                    <div class="desc">–†–µ–ª—è—Ç–∏–≤—ñ—Å—Ç—Å—å–∫–∞ –ø–æ–ø—Ä–∞–≤–∫–∞</div>
                </div>
                <div class="card">
                    <div class="label">NETWORK LATENCY</div>
                    <div class="value" id="latency">--</div>
                    <div class="desc">–ü—Ä–æ–∫—Å—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ–≥–æ —á–∞—Å—É</div>
                </div>
                <div class="card">
                    <div class="label">TEMPORAL DRIFT</div>
                    <div class="value" id="drift">--</div>
                    <div class="desc">–í—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —á–∞—Å–æ–≤–∏—Ö —Å–∏—Å—Ç–µ–º</div>
                </div>
                <div class="matrixCard">
                    <canvas id="matrixTime"></canvas>
                </div>
            </div>
            <div class="bigIndex">
                <div class="label">TIME IBONARIUM INDEX</div>
                <div class="indexValue" id="timeIndex">--</div>
                <div class="alertBox" id="timeAlert">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö...</div>
            </div>
            <div class="footer">UPDATE 500ms ¬∑ TEMPORAL MATRIX ACTIVE</div>
        </div>
    </div>

    <!-- –ü–†–ê–í–ò–ô –†–ê–î–ê–†: UNCERTAINTY RADAR -->
    <div class="section right">
        <div class="container">
            <h1>IBONARIUM ¬∑ UNCERTAINTY RADAR</h1>
            <div class="subtitle">–ö–≤–∞–Ω—Ç–æ–≤–∞ –µ–Ω—Ç—Ä–æ–ø—ñ—è ¬∑ –ì–ª–æ–±–∞–ª—å–Ω–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω—ñ—Å—Ç—å</div>
            <div class="grid">
                <div class="card">
                    <div class="label">QUANTUM ENTROPY (ANU)</div>
                    <div class="value" id="entropy">--</div>
                    <div class="desc">–†–µ–∞–ª—å–Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤–∞ –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å</div>
                </div>
                <div class="card">
                    <div class="label">GCP DEVIATION</div>
                    <div class="value" id="gcpDev">--</div>
                    <div class="desc">–ì–ª–æ–±–∞–ª—å–Ω–∞ –º–µ—Ä–µ–∂–∞ RNG</div>
                </div>
                <div class="card">
                    <div class="label">NETWORK COHERENCE</div>
                    <div class="value" id="coherence">--</div>
                    <div class="desc">–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å / —Ä–æ–∑—É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å</div>
                </div>
                <div class="card">
                    <div class="label">UNCERTAINTY INDEX</div>
                    <div class="value" id="uncertaintyIndex">--</div>
                    <div class="desc">–°–∏–Ω—Ç–µ—Ç–∏—á–Ω–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å</div>
                </div>
                <div class="matrixCard">
                    <canvas id="matrixUncertainty"></canvas>
                </div>
            </div>
            <div class="bigIndex">
                <div class="label">UNCERTAINTY IBONARIUM INDEX</div>
                <div class="indexValue" id="mainUncertaintyIndex">--</div>
                <div class="alertBox" id="uncertaintyAlert">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...</div>
            </div>
            <div class="footer">ANU QRNG ¬∑ GCP ¬∑ ~60s update</div>
        </div>
    </div>

</div>

<script>
// ================================================
// –°–ü–Ü–õ–¨–ù–ò–ô –§–û–ù –ó–Ü–†–û–ö
// ================================================
const starCanvas = document.getElementById('starCanvas');
const starCtx = starCanvas.getContext('2d');
let stars = [];
function resizeStars() {
    starCanvas.width = window.innerWidth;
    starCanvas.height = window.innerHeight;
    stars = Array(180).fill().map(() => ({
        x: Math.random() * starCanvas.width,
        y: Math.random() * starCanvas.height,
        z: Math.random() * 1.6 + 0.4,
        color: `hsl(${Math.random()*360}, 80%, 70%)`
    }));
}
window.addEventListener('resize', resizeStars);
resizeStars();
function drawStars() {
    starCtx.fillStyle = 'rgba(0,0,0,0.7)';
    starCtx.fillRect(0,0,starCanvas.width,starCanvas.height);
    stars.forEach(s => {
        s.y -= 0.15 * s.z;
        if (s.y < 0) {
            s.y = starCanvas.height;
            s.x = Math.random() * starCanvas.width;
        }
        starCtx.fillStyle = s.color;
        starCtx.beginPath();
        starCtx.arc(s.x, s.y, s.z * 1.5, 0, Math.PI*2);
        starCtx.fill();
    });
    requestAnimationFrame(drawStars);
}
drawStars();

// ================================================
// TIME MONITOR (–ª—ñ–≤–∏–π)
// ================================================
const timeMatrixCanvas = document.getElementById("matrixTime");
const timeCtx = timeMatrixCanvas.getContext("2d");
let timeDrops = [];
const timeFontSize = 12;
let timeColumns;
let timeMatrixSpeed = 1;
let timeMatrixDensity = 0.7;
let timeMatrixColor = "#00ff9c";

function resizeTimeMatrix() {
    timeMatrixCanvas.width = timeMatrixCanvas.clientWidth;
    timeMatrixCanvas.height = timeMatrixCanvas.clientHeight;
    timeColumns = Math.floor(timeMatrixCanvas.width / timeFontSize);
    timeDrops = Array(timeColumns).fill(1);
}
window.addEventListener("resize", resizeTimeMatrix);
resizeTimeMatrix();

function updateTimeMatrix(index, drift) {
    timeMatrixSpeed = 0.5 + index * 2;
    timeMatrixDensity = 0.5 + drift;
    if (index < 0.4) timeMatrixColor = "#00ff9c";
    else if (index < 0.7) timeMatrixColor = "#ffaa00";
    else timeMatrixColor = "#ff3366";
}

function drawTimeMatrix() {
    timeCtx.fillStyle = "rgba(0,0,0,0.08)";
    timeCtx.fillRect(0,0,timeMatrixCanvas.width,timeMatrixCanvas.height);
    timeCtx.fillStyle = timeMatrixColor;
    timeCtx.font = timeFontSize + "px monospace";
    for (let i = 0; i < timeDrops.length; i++) {
        if (Math.random() < timeMatrixDensity) {
            const text = Math.random() > 0.5 ? "1" : "0";
            timeCtx.fillText(text, i * timeFontSize, timeDrops[i] * timeFontSize);
        }
        if (timeDrops[i] * timeFontSize > timeMatrixCanvas.height && Math.random() > 0.975) timeDrops[i] = 0;
        timeDrops[i] += timeMatrixSpeed;
    }
    requestAnimationFrame(drawTimeMatrix);
}
drawTimeMatrix();

// ================================================
// UNCERTAINTY RADAR (–ø—Ä–∞–≤–∏–π)
// ================================================
const uncMatrixCanvas = document.getElementById("matrixUncertainty");
const uncCtx = uncMatrixCanvas.getContext("2d");
let uncDrops = [];
const uncFontSize = 12;                     // –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É
let uncColumns;
let uncMatrixSpeed = 1;
let uncMatrixDensity = 0.7;
let uncMatrixColor = "#9933ff";

function resizeUncMatrix() {
    uncMatrixCanvas.width = uncMatrixCanvas.clientWidth;
    uncMatrixCanvas.height = uncMatrixCanvas.clientHeight;
    uncColumns = Math.floor(uncMatrixCanvas.width / uncFontSize);
    uncDrops = Array(uncColumns).fill(1);
}
window.addEventListener("resize", resizeUncMatrix);
resizeUncMatrix();

function updateUncMatrixStyle(index) {
    uncMatrixSpeed = 0.6 + index * 3.8;
    uncMatrixDensity = 0.3 + index * 1.0;
    if (index < 0.35) uncMatrixColor = "#a0ffdd";
    else if (index < 0.68) uncMatrixColor = "#ffdd44";
    else uncMatrixColor = "#ff4488";
}

function drawUncMatrix() {
    uncCtx.fillStyle = "rgba(0,0,0,0.06)";
    uncCtx.fillRect(0,0,uncMatrixCanvas.width,uncMatrixCanvas.height);
    uncCtx.fillStyle = uncMatrixColor;
    uncCtx.font = uncFontSize + "px monospace";
    for (let i = 0; i < uncDrops.length; i++) {
        if (Math.random() < uncMatrixDensity) {
            const text = Math.random() > 0.5 ? "1" : "0";
            uncCtx.fillText(text, i * uncFontSize, uncDrops[i] * uncFontSize);
        }
        if (uncDrops[i] * uncFontSize > uncMatrixCanvas.height && Math.random() > 0.96) uncDrops[i] = 0;
        uncDrops[i] += uncMatrixSpeed;
    }
    requestAnimationFrame(drawUncMatrix);
}
drawUncMatrix();

// ================================================
// –õ–û–ì–Ü–ö–ê TIME (–ª—ñ–≤–∏–π)
// ================================================
function updateAtomicTime() {
    document.getElementById("atomicTime").textContent = new Date().toISOString().replace("T", " ").substr(0,19);
}

function updateGpsOffset() {
    const base = 38;
    const noise = (Math.random()-0.5)*3;
    const value = base + noise;
    document.getElementById("gpsOffset").textContent = value.toFixed(3) + " Œºs";
    return value;
}

async function measureLatency() {
    try {
        const start = performance.now();
        await fetch("https://worldtimeapi.org/api/timezone/Etc/UTC", {cache:"no-store"});
        const end = performance.now();
        const lat = (end - start).toFixed(1) + " ms";
        document.getElementById("latency").textContent = lat;
        return end - start;
    } catch {
        document.getElementById("latency").textContent = "offline";
        return 0;
    }
}

function calcDrift(gps, latency) {
    return Math.abs(gps / 40 - latency / 200);
}

function calcTimeIbonariumIndex(gps, latency, drift) {
    return (gps/40)*0.45 + (latency/200)*0.35 + drift*0.2;
}

function updateTimeAlert(index) {
    const box = document.getElementById("timeAlert");
    if (index < 0.4) {
        box.innerHTML = "üü¢ –°–ò–ù–•–†–û–ù–Ü–Ø ¬∑ –°—Ç–∞–±—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä-—á–∞—Å";
        box.style.borderColor = "#00ff9c";
    } else if (index < 0.7) {
        box.innerHTML = "üü° –§–ê–ó–û–í–ò–ô –ó–°–£–í ¬∑ –ß–∞—Å–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏ —Ä–æ–∑—Ö–æ–¥—è—Ç—å—Å—è";
        box.style.borderColor = "#ffaa00";
    } else {
        box.innerHTML = "üî¥ TEMPORAL TURBULENCE ¬∑ –ô–º–æ–≤—ñ—Ä–Ω—ñ —Ñ–∞–∑–æ–≤—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏";
        box.style.borderColor = "#ff3366";
    }
}

async function timeMainLoop() {
    updateAtomicTime();
    const gps = updateGpsOffset();
    const latency = await measureLatency();
    const drift = calcDrift(gps, latency);
    document.getElementById("drift").textContent = drift.toFixed(3);
    const index = calcTimeIbonariumIndex(gps, latency, drift);
    document.getElementById("timeIndex").textContent = index.toFixed(3);
    updateTimeAlert(index);
    updateTimeMatrix(index, drift);
}

// ================================================
// –õ–û–ì–Ü–ö–ê UNCERTAINTY (–ø—Ä–∞–≤–∏–π)
// ================================================
async function fetchAnuEntropy() {
    try {
        const res = await fetch('https://qrng.anu.edu.au/API/jsonI.php?length=8&type=uint8');
        const json = await res.json();
        if (json.success && json.data) {
            const nums = json.data;
            const mean = nums.reduce((a,b)=>a+b,0) / nums.length;
            const varc = nums.reduce((a,b)=>a + (b-mean)**2, 0) / nums.length;
            return Math.min(1, varc / 6000);
        }
    } catch {}
    return Math.random();
}

async function fetchGcpDeviation() {
    try {
        const proxy = 'https://corsproxy.io/?' + encodeURIComponent('https://gcpdot.com/');
        const res = await fetch(proxy);
        const text = await res.text();
        const match = text.match(/Dot.*?([0-9.-]+).*?(red|yellow|green)/is) || [];
        let dev = parseFloat(match[1]) || (Math.random() - 0.5) * 1.2;
        if (isNaN(dev)) dev = (Math.random() - 0.5) * 1.5;
        if (match[2]?.toLowerCase().includes('red')) dev = Math.abs(dev) + 1.2;
        return dev;
    } catch {
        return (Math.random() < 0.08 ? (Math.random()*5 - 2.5) : (Math.random()-0.5)*0.9);
    }
}

async function updateUncertainty() {
    const entropy = await fetchAnuEntropy();
    const gcpDev = await fetchGcpDeviation();
    const coherence = Math.max(0, 1 - Math.abs(gcpDev) * 0.7);
    const uncertainty = (1 - entropy) * 0.4 + Math.abs(gcpDev) * 0.5 + (1 - coherence) * 0.1;

    document.getElementById("entropy").textContent = entropy.toFixed(4);
    document.getElementById("gcpDev").textContent = gcpDev.toFixed(3) + (Math.abs(gcpDev)>1.2 ? " ‚ö†" : "");
    document.getElementById("coherence").textContent = coherence.toFixed(3);
    document.getElementById("uncertaintyIndex").textContent = uncertainty.toFixed(4);
    document.getElementById("mainUncertaintyIndex").textContent = uncertainty.toFixed(4);

    const box = document.getElementById("uncertaintyAlert");
    updateUncMatrixStyle(uncertainty);

    if (uncertainty < 0.35) {
        box.innerHTML = "üü¢ –í–ò–°–û–ö–ê –í–ò–ü–ê–î–ö–û–í–Ü–°–¢–¨<br>–ö–≤–∞–Ω—Ç–æ–≤–∞ –µ–Ω—Ç—Ä–æ–ø—ñ—è —Ç–∞ GCP —Å—Ç–∞–±—ñ–ª—å–Ω—ñ";
        box.style.borderColor = "#a0ffdd";
    } else if (uncertainty < 0.68) {
        box.innerHTML = "üü° –ü–û–ú–Ü–¢–ù–ê –ö–û–ì–ï–†–ï–ù–¢–ù–Ü–°–¢–¨<br>–ú–æ–∂–ª–∏–≤–∞ —Å–ª–∞–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è —Å–≤—ñ–¥–æ–º–æ—Å—Ç—ñ";
        box.style.borderColor = "#ffdd44";
    } else {
        box.innerHTML = "üî¥ –ê–ù–û–ú–ê–õ–¨–ù–ê –ù–ï–í–ò–ó–ù–ê–ß–ï–ù–Ü–°–¢–¨<br>–ó–Ω–∞—á–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è ‚Üí –º–æ–∂–ª–∏–≤–∞ –ø–æ–¥—ñ—è";
        box.style.borderColor = "#ff4488";
    }
}

// ================================================
// –ó–ê–ü–£–°–ö
// ================================================
setInterval(timeMainLoop, 500);
timeMainLoop();

setInterval(updateUncertainty, 60000);
updateUncertainty();

// –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø—É—Å–∫ –º–∞—Ç—Ä–∏—Ü—å
drawTimeMatrix();
drawUncMatrix();
</script>
</body>
</html>
